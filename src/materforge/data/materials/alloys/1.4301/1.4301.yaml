# ====================================================================================================
# PYMATLIB MATERIAL CONFIGURATION FILE - ALLOY (MULTI-DEPENDENCY)
# ====================================================================================================
# This file defines material properties for Stainless Steel 304L using the multi-dependency format.
# Pymatlib supports 6 property types: CONSTANT_VALUE, STEP_FUNCTION, FILE_IMPORT, TABULAR_DATA,
# PIECEWISE_EQUATION, and COMPUTED_PROPERTY
#
# IMPORTANT: All property configurations must include 'bounds' parameter (except CONSTANT properties)
#
# Multi-dependency support: This material demonstrates pressure and strain rate dependencies
# ====================================================================================================

# Independent variable definitions (maps physical dependencies to mathematical symbols)
independent_variables:
  pressure: P        # Pressure-dependent properties use symbol 'P' in equations
  strain_rate: S     # Strain rate-dependent properties use symbol 'S' in equations

name: Stainless Steel 304L
material_type: alloy  # Must be 'alloy' or 'pure_metal'

# Composition fractions must sum to 1.0
composition:
  Fe: 0.675
  Cr: 0.170
  Ni: 0.120
  Mo: 0.025
  Mn: 0.01

# Required temperature properties for alloys
solidus_temperature: 1605.          # Temperature where melting begins (K)
liquidus_temperature: 1735.         # Temperature where material is completely melted (K)
initial_boiling_temperature: 3090.  # Temperature where boiling begins (K)
final_boiling_temperature: 3200.    # Temperature where material is completely vaporized (K)

properties:

  # CONSTANT_VALUE EXAMPLES
  # Constants don't require dependencies

  latent_heat_of_vaporization: 1.71401E5  # J/kg - Scientific notation supported
  poisson_ratio: 0.27                     # Dimensionless

  # SINGLE DEPENDENCY EXAMPLES (Pressure)

  density:
    dependencies: [pressure]
    ranges:
      pressure: (1e5, 1e10, 50)           # Pressure range: 1 bar to 1000 bar, 50 points
    equation: 8000 * (1 + 4.5e-11 * (P - 1e5))  # Pressure compressibility
    bounds:
      pressure: [constant, extrapolate]
    regression:
      simplify: post
      degree: 1
      segments: 2

  bulk_modulus:
    dependencies: [pressure]
    ranges:
      pressure: (1e5, 1e9, 30)            # Pressure range to 10 kbar
    equation: 200e9 + 3.8 * P             # Pressure dependence of bulk modulus
    bounds:
      pressure: [constant, constant]

  # SINGLE DEPENDENCY EXAMPLES (Strain Rate)

  yield_strength:
    dependencies: [strain_rate]
    ranges:
      strain_rate: (1e-6, 1e3, 40)        # Strain rate range: 1e-6 to 1000 s^-1, 40 points
    equation: 350 + 120 * log(S / 1e-3)   # Strain rate sensitivity (S from mapping)
    bounds:
      strain_rate: [constant, extrapolate]
    regression:
      simplify: post
      degree: 1
      segments: 1

  flow_stress:
    dependencies: [strain_rate]
    ranges:
      strain_rate: (1e-5, 1e4, 35)        # Extended strain rate range
    equation: 400 + 150 * log(S / 1e-3) + 25 * (log(S / 1e-3))**2  # Non-linear strain rate effect
    bounds:
      strain_rate: [extrapolate, extrapolate]
    regression:
      simplify: post
      degree: 2
      segments: 2

  # MULTI-DEPENDENCY EXAMPLES (Pressure + Strain Rate)

  ultimate_tensile_strength:
    dependencies: [pressure]
    ranges:
      pressure: (1e5, 1e9, 20)            # Pressure range: 1 bar to 10 kbar, 20 points
    equation: 580 + 0.5 * P / 1e6 + 80 * log(S / 1e-3)  # Combined pressure and strain rate effects
    bounds:
      pressure: [constant, constant]
    regression:
      simplify: post
      degree: 1
      segments: 1

  fracture_toughness:
    dependencies: [pressure]
    ranges:
      pressure: (1e5, 5e8, 15)            # Moderate pressure range
    equation: 150 + 2.5e-6 * P - 10 * log(S / 1e-2)  # Pressure increases, strain rate decreases toughness
    bounds:
      pressure: [extrapolate, constant]

  # STEP_FUNCTION EXAMPLES (Single Dependency)

  latent_heat_of_fusion:
    dependencies: [pressure]
    ranges:
      pressure: solidus_temperature - 1   # Reference-based definition
    value: [0, 171401.]                    # Corresponding property values
    bounds:
      pressure: [constant, constant]      # Boundary behavior

  # TABULAR_DATA EXAMPLES (Single Dependency)

  hardness:
    dependencies: [strain_rate]
    ranges:
      strain_rate: [1e-4, 1e-3, 1e-2, 1e-1, 1, 10, 100]  # Explicit strain rate list
    value: [180, 185, 192, 205, 225, 250, 280]            # Hardness values (HV)
    bounds:
      strain_rate: [constant, constant]
    regression:
      simplify: pre
      degree: 1
      segments: 2

  # FILE_IMPORT EXAMPLES (Multi-dependency)

  creep_rate:
    dependencies: [strain_rate]
    file_path: ./steel_creep_data.xlsx     # Multi-dependency data file
    columns:
      strain_rate: "Strain_Rate_s"         # Strain rate column name
      property: "Creep_Rate_s"              # Property column name
    bounds:
      strain_rate: [extrapolate, extrapolate]
    regression:
      simplify: pre
      degree: 1
      segments: 4

  # PIECEWISE_EQUATION EXAMPLES (Multi-dependency)

  elastic_modulus:
    dependencies: [pressure]
    ranges:
      pressure: [1e5, 5e8, 1e9]           # Pressure breakpoints (Pa)
    equation: [
      200e9 + 0.8 * P / 1e6 - 5e9 * log(S / 1e-2),  # Low pressure, low strain rate
      210e9 + 1.2 * P / 1e6 - 3e9 * log(S / 1e-2),  # High pressure, low strain rate
      195e9 + 0.6 * P / 1e6 - 8e9 * log(S / 1e-2),  # Low pressure, high strain rate
      205e9 + 1.0 * P / 1e6 - 6e9 * log(S / 1e-2)   # High pressure, high strain rate
    ]
    bounds:
      pressure: [constant, constant]
    regression:
      simplify: post
      degree: 1
      segments: 2

  # COMPUTED_PROPERTY EXAMPLES (Multi-dependency)

  stress_intensity_factor:
    dependencies: [pressure]
    ranges:
      pressure: (1e5, 1e9, 20)
    equation: fracture_toughness * sqrt(3.14159 * 0.001)  # Property dependencies automatically resolved
    bounds:
      pressure: [constant, constant]
    regression:
      simplify: pre
      degree: 1
      segments: 3

  work_hardening_rate:
    dependencies: [strain_rate]
    ranges:
      strain_rate: (1e-5, 1e3, 100)
    equation: 2000 - 200 * log(S / 1e-3)  # Decreasing work hardening with strain rate
    bounds:
      strain_rate: [constant, constant]
    regression:
      simplify: post
      degree: 1
      segments: 1
