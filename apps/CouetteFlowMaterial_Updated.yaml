# ====================================================================================================
# MATERFORGE MATERIAL CONFIGURATION FILE
# ====================================================================================================
# Material properties for Couette flow simulation with temperature-dependent viscosity
# Higher viscosity values for numerical stability
# ====================================================================================================

name: "CouetteFlowSteel"
material_type: alloy

composition:
  Fe: 0.70
  C: 0.01
  Cr: 0.18
  Ni: 0.08
  Mn: 0.02
  Si: 0.01

# Temperature properties
solidus_temperature: 1673.0
liquidus_temperature: 1723.0
initial_boiling_temperature: 3100.0
final_boiling_temperature: 3200.0

properties:
  # ====================================================================================================
  # CONSTANT PROPERTIES
  # ====================================================================================================
  
  latent_heat_of_fusion: 270000.0
  latent_heat_of_vaporization: 6300000.0

  # ====================================================================================================
  # DENSITY - Temperature-dependent (thermal expansion)
  # ====================================================================================================
  
  density:
    dependency: (300, 600, 31)
    equation: 7850.0 / (1.0 + 3.0 * thermal_expansion_coefficient * (T - 293.15))
    bounds: [constant, constant]
    regression:
      simplify: post
      degree: 2
      segments: 2

  # ====================================================================================================
  # THERMAL EXPANSION COEFFICIENT - Temperature-dependent
  # ====================================================================================================
  
  thermal_expansion_coefficient:
    dependency: [300, 400, 500, 600]
    value: [11.7e-6, 12.8e-6, 13.5e-6, 14.0e-6]
    bounds: [constant, constant]
    regression:
      simplify: post
      degree: 1
      segments: 1

  # ====================================================================================================
  # HEAT CAPACITY - Temperature-dependent
  # ====================================================================================================
  
  heat_capacity:
    dependency: [300, 400, 500, 600]
    value: [460, 500, 520, 540]
    bounds: [constant, constant]
    regression:
      simplify: post
      degree: 2
      segments: 2

  # ====================================================================================================
  # THERMAL CONDUCTIVITY - Temperature-dependent 
  # ====================================================================================================
  
  heat_conductivity:
    dependency: [300, 400, 500, 600]
    value: [16.3, 18.5, 20.8, 23.1]
    bounds: [constant, constant]
    regression:
      simplify: post
      degree: 1
      segments: 2

  # ====================================================================================================
  # DYNAMIC VISCOSITY - Higher values for numerical stability
  # ====================================================================================================
  
  dynamic_viscosity:
    dependency: (300, 600, 31)  # Temperature range 300-600K, 31 points
    equation: 0.02 * exp(-0.0005 * (T - 300.0))  # Higher base viscosity, smaller temperature coefficient
    # μ(T) = 0.02 * exp(-0.0005 * (T - 300))
    # At 300K: μ = 0.02 Pa·s (20 mPa·s) - MUCH HIGHER
    # At 400K: μ = 0.019 Pa·s (19 mPa·s) - Still high and stable
    # At 500K: μ = 0.018 Pa·s (18 mPa·s) - Gradual decrease
    # At 600K: μ = 0.017 Pa·s (17 mPa·s) - Gradual decrease
    bounds: [constant, constant]
    regression:
      simplify: post
      degree: 2
      segments: 2

  # ====================================================================================================
  # COMPUTED PROPERTIES
  # ====================================================================================================
  
  thermal_diffusivity:
    dependency: (300, 600, 31)
    equation: heat_conductivity / (density * heat_capacity)
    bounds: [constant, constant]
    regression:
      simplify: post
      degree: 2
      segments: 2

  kinematic_viscosity:
    dependency: (300, 600, 31)
    equation: dynamic_viscosity / density
    bounds: [constant, constant]
    regression:
      simplify: post
      degree: 2
      segments: 2

  specific_enthalpy:
    dependency: (300, 600, 31)
    equation: Integral(heat_capacity, T)
    bounds: [constant, constant]
    regression:
      simplify: post
      degree: 2
      segments: 2

  energy_density:
    dependency: (300, 600, 31)
    equation: density * specific_enthalpy
    bounds: [extrapolate, extrapolate]
    regression:
      simplify: post
      degree: 2
      segments: 2

# ====================================================================================================
# KEY CHANGES FOR NUMERICAL STABILITY:
#
# 1. HIGHER BASE VISCOSITY: 0.02 Pa·s (20 mPa·s) instead of 0.001 Pa·s (1 mPa·s)
# 2. SMALLER TEMPERATURE COEFFICIENT: -0.0005 instead of -0.002
# 3. REDUCED TEMPERATURE RANGE: 300-600K instead of 300-1200K  
# 4. GRADUAL VISCOSITY VARIATION: ~15% change (20→17 mPa·s) instead of 500% change
# 5. CONSISTENT VALUES: C++ initial values match YAML base values
#
# EXPECTED VISCOSITY VALUES:
# - At 300K: μ = 0.020 Pa·s (20.0 mPa·s)
# - At 400K: μ = 0.019 Pa·s (19.0 mPa·s) 
# - At 500K: μ = 0.018 Pa·s (18.1 mPa·s)
# - At 600K: μ = 0.017 Pa·s (17.1 mPa·s)
#
# ====================================================================================================
